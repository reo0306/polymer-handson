<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../google-apis/google-maps-api.html"></head><body><dom-module id="google-map-directions"><template><style>:host{display:none;}</style><google-maps-api api-key="[[apiKey]]" language="[[language]]" on-api-load="_mapApiLoaded" maps-url="[[mapsUrl]]"></google-maps-api></template><script>Polymer({is:'google-map-directions',properties:{apiKey:String,mapsUrl:{type:String},map:{type:Object,observer:'_mapChanged'},startAddress:{type:String,value:null},endAddress:{type:String,value:null},travelMode:{type:String,value:'DRIVING'},waypoints:{type:Array,value:function(){return[]}},language:{type:String,value:null},rendererOptions:{type:Object,value:function(){return{}}},response:{type:Object,observer:'_responseChanged',notify:!0}},observers:['_route(startAddress, endAddress, travelMode, waypoints.*)'],_mapApiLoaded:function(){this._route()},_responseChanged:function(){this.directionsRenderer&&this.response&&this.directionsRenderer.setDirections(this.response)},_mapChanged:function(){this.map&&this.map instanceof google.maps.Map?(!this.directionsRenderer&&(this.directionsRenderer=new google.maps.DirectionsRenderer(this.rendererOptions)),this.directionsRenderer.setMap(this.map),this._responseChanged()):this.directionsRenderer&&(this.directionsRenderer.setMap(null),this.directionsRenderer=null)},_route:function(){if('undefined'!=typeof google&&'undefined'!=typeof google.maps&&this.startAddress&&this.endAddress){this.directionsService||(this.directionsService=new google.maps.DirectionsService);var a={origin:this.startAddress,destination:this.endAddress,travelMode:this.travelMode,waypoints:this.waypoints};this.directionsService.route(a,function(a,b){b==google.maps.DirectionsStatus.OK&&(this.response=a,this.fire('google-map-response',{response:a}))}.bind(this))}}});</script></dom-module></body></html>